<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebArchive to Text Converter - Free Online Tool</title>
    <meta name="description" content="Free online tool to convert iOS Safari .webarchive files to plain text. Upload your .webarchive file and download clean, readable text instantly.">
    <meta name="keywords" content="webarchive converter, webarchive to text, ios safari converter, webarchive reader, convert webarchive">
    <meta name="author" content="WebArchive Converter">
    
    <!-- Open Graph for social sharing -->
    <meta property="og:title" content="WebArchive to Text Converter">
    <meta property="og:description" content="Convert iOS Safari .webarchive files to plain text for free">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://webarchieve-converter.onrender.com/">
    
    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="WebArchive to Text Converter">
    <meta name="twitter:description" content="Convert iOS Safari .webarchive files to plain text for free">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: #f5f5f5; padding: 20px; }
        .container { max-width: 600px; margin: 50px auto; background: white; padding: 40px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        h1 { font-size: 24px; margin-bottom: 10px; color: #333; }
        p { color: #666; margin-bottom: 30px; }
        .drop-zone { border: 2px dashed #ccc; border-radius: 8px; padding: 60px 20px; text-align: center; cursor: pointer; transition: all 0.3s; }
        .drop-zone:hover, .drop-zone.drag-over { border-color: #007aff; background: #f0f8ff; }
        .drop-zone input { display: none; }
        .drop-zone-text { color: #666; font-size: 16px; }
        .drop-zone-hint { color: #999; font-size: 14px; margin-top: 10px; }
        .status { margin-top: 20px; padding: 15px; border-radius: 6px; display: none; }
        .status.error { background: #fee; color: #c00; display: block; }
        .status.success { background: #efe; color: #060; display: block; }
        .status.processing { background: #fef9e7; color: #856404; display: block; }
        .info { margin-top: 40px; padding-top: 40px; border-top: 1px solid #eee; }
        .info h2 { font-size: 20px; margin: 20px 0 10px; color: #333; }
        .info p, .info li { color: #666; line-height: 1.6; margin-bottom: 10px; }
        .info ol, .info ul { margin-left: 20px; }
    </style>
</head>
<body>
    <div class="container">
        <h1>WebArchive to Text Converter</h1>
        <p>Convert iOS Safari .webarchive files to plain text</p>
        
        <div class="drop-zone" id="dropZone">
            <input type="file" id="fileInput" accept=".webarchive">
            <div class="drop-zone-text">Click to select or drag & drop .webarchive file</div>
            <div class="drop-zone-hint">Maximum file size: 50MB</div>
        </div>
        
        <div class="status" id="status"></div>
        
        <div class="info">
            <h2>How to Use</h2>
            <ol>
                <li>Export a webpage as .webarchive from iOS Safari (Share â†’ Save to Files)</li>
                <li>Upload the .webarchive file using the form above</li>
                <li>Download the converted plain text file instantly</li>
            </ol>
            
            <h2>Features</h2>
            <ul>
                <li>Free and unlimited conversions</li>
                <li>No registration required</li>
                <li>Files processed securely (not stored)</li>
                <li>Preserves paragraph structure and formatting</li>
                <li>Supports files up to 50MB</li>
            </ul>
            
            <h2>About WebArchive Format</h2>
            <p>WebArchive is Apple's proprietary format used by Safari on iOS and macOS to save complete webpages. This tool extracts the text content from these files, making it readable on any device without requiring Apple software.</p>
        </div>
    </div>

    <script>
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const status = document.getElementById('status');

        dropZone.addEventListener('click', () => fileInput.click());
        
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        dropZone.addEventListener('dragover', (e) => {
            e.preventDefault();
            dropZone.classList.add('drag-over');
        });

        dropZone.addEventListener('dragleave', () => {
            dropZone.classList.remove('drag-over');
        });

        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            dropZone.classList.remove('drag-over');
            if (e.dataTransfer.files.length > 0) {
                handleFile(e.dataTransfer.files[0]);
            }
        });

        async function handleFile(file) {
            status.className = 'status processing';
            status.textContent = 'Processing...';

            const formData = new FormData();
            formData.append('file', file);

            try {
                const response = await fetch('/api/convert', {
                    method: 'POST',
                    body: formData
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.detail || 'Conversion failed');
                }

                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'converted.txt';
                a.click();
                window.URL.revokeObjectURL(url);

                status.className = 'status success';
                status.textContent = 'Conversion successful! File downloaded.';
            } catch (error) {
                status.className = 'status error';
                status.textContent = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>
